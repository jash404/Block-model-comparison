"use strict";(self.webpackChunkjupyterlab_execute_time=self.webpackChunkjupyterlab_execute_time||[]).push([[568],{729:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PLUGIN_NAME=void 0;const n=i(510),s=i(797),o=i(685),a=i(192);t.PLUGIN_NAME="jupyterlab-execute-time";class l extends n.Widget{constructor(e,i,n){super(),this._cellSlotMap={},this._settings={enabled:!1,highlight:!0,positioning:"left",minTime:0},this._panel=e,this._tracker=i,this.updateConnectedCell=this.updateConnectedCell.bind(this),n.load(`${t.PLUGIN_NAME}:settings`).then((e=>{this._updateSettings(e),e.changed.connect(this._updateSettings.bind(this))}),(e=>{console.error(`jupyterlab-execute-time: Could not load settings, so did not active ${t.PLUGIN_NAME}: ${e}`)}))}updateConnectedCell(e,t){t.oldValues.forEach(this._deregisterMetadataChanges.bind(this)),t.newValues.forEach(this._registerMetadataChanges.bind(this))}_registerMetadataChanges(e){if(!(e.id in this._cellSlotMap)){const t=()=>this._cellMetadataChanged(e);this._cellSlotMap[e.id]=t,e.metadata.changed.connect(t)}this._cellMetadataChanged(e,!0)}_deregisterMetadataChanges(e){const t=this._cellSlotMap[e.id];if(t){e.metadata.changed.disconnect(t);const i=this._getCodeCell(e);i&&this._removeExecuteNode(i)}delete this._cellSlotMap[e.id]}_cellMetadataChanged(e,t=!1){const i=this._getCodeCell(e);i?this._updateCodeCell(i,t):"code"===e.type&&console.error(`Could not find code cell for model: ${e}`)}_getCodeCell(e){return"code"===e.type?this._panel.content.widgets.find((t=>t.model===e)):null}_removeExecuteNode(e){const t=e.node.querySelector(".execute-time");t&&t.remove()}_updateCodeCell(e,t){const i=e.model.metadata.get("execution");if(i&&s.JSONExt.isObject(i)){let n=e.node.querySelector(".execute-time");const s="hover"===this._settings.positioning?e.inputArea.node.parentNode:e.inputArea.editorWidget.node;let l;switch(n?n.parentNode!==s&&(n.remove(),s.append(n)):(n=document.createElement("div"),e.inputHidden||s.append(n)),n.onclick=()=>{this._tracker.activeCell!==e&&e.activate()},this._settings.positioning){case"left":l="left";break;case"right":l="right";break;case"hover":l="hover";break;default:console.error(`'${l}' is not a valid type for the setting 'positioning'`)}const r=`execute-time-positioning-${this._settings.positioning}`;n.className=`execute-time ${r}`;const c=i["iopub.status.busy"],d=c?new Date(c):null,u=i["shell.execute_reply.started"]||i["iopub.execute_input"],h=u?new Date(u):null,g=i["shell.execute_reply"],_=g?new Date(g):null;let p="";g&&!i["iopub.execute_input"]?p="":_?this._settings.minTime<=a.differenceInMilliseconds(_,h)/1e3&&(p=`Last executed at ${o.getTimeString(_)} in ${o.getTimeDiff(_,h)}`):h?p=`Execution started at ${o.getTimeString(h)}`:d&&(p=`Execution queued at ${o.getTimeString(d)}`),n.innerText!==p&&(n.innerText=p,!t&&this._settings.highlight&&g&&(n.style.setProperty("animation","executeHighlight 1000ms"),setTimeout((()=>n.style.removeProperty("animation")),1e3)))}else this._removeExecuteNode(e)}_updateSettings(e){this._settings.enabled=e.get("enabled").composite,this._settings.highlight=e.get("highlight").composite,this._settings.positioning=e.get("positioning").composite,this._settings.minTime=e.get("minTime").composite;const t=this._panel.context.model.cells;if(this._settings.enabled){t.changed.connect(this.updateConnectedCell);for(let e=0;e<t.length;++e)this._registerMetadataChanges(t.get(e))}else{t.changed.disconnect(this.updateConnectedCell);for(let e=0;e<t.length;++e)this._deregisterMetadataChanges(t.get(e))}}}t.default=l},685:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getTimeDiff=t.getTimeString=void 0;const n=i(192);t.getTimeString=e=>n.format(e,"yyy-MM-dd HH:mm:ss"),t.getTimeDiff=(e,t)=>{const i=36e5,s=864e5;let o=n.differenceInMilliseconds(e,t);if(o<1e3)return`${o}ms`;const a=Math.floor(o/s);o%=s;const l=Math.floor(o/i);o%=i;const r=Math.floor(o/6e4);o%=6e4;let c="";return a&&(c+=`${a}d `),(a||l)&&(c+=`${l}h `),(a||l||r)&&(c+=`${r}m `),a||(c+=`${(o/1e3).toFixed(l?0:2)}s`),c.trim()}},568:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});const a=i(611),l=i(904),r=o(i(729));class c{constructor(e,t){this._settingRegistry=t,this._tracker=e}createNew(e,t){return new r.default(e,this._tracker,this._settingRegistry)}}const d={id:r.PLUGIN_NAME,autoStart:!0,requires:[a.INotebookTracker,l.ISettingRegistry],activate:(e,t,i)=>{e.docRegistry.addWidgetExtension("Notebook",new c(t,i)),console.log("JupyterLab extension jupyterlab-execute-time is activated!")}};t.default=d}}]);